{"paragraphs":[{"text":"%pyspark\npath = \"/share_dir/CleanData/*.json\"\nhtmlDF = spark.read.json(path)\n\nhtmlDF.show()","user":"anonymous","dateUpdated":"2018-11-13T17:47:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0","http://172.17.0.2:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1541697994708_-1630879790","id":"20181104-200134_1140668042","dateCreated":"2018-11-08T17:26:34+0000","dateStarted":"2018-11-13T17:47:50+0000","dateFinished":"2018-11-13T17:48:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4764"},{"text":"%pyspark\nimport nltk\n# find number of records in the document\ntext = htmlDF.select(\"Sentences\",'URL').rdd\ndf = (htmlDF.rdd.map(lambda x : (x.URL, x.Sentences.split(\" \"))).toDF()).withColumnRenamed(\"_1\", \"id\").withColumnRenamed(\"_2\", \"words\")\ndf.drop_duplicates(keep = 'first')\n\nfulltextstringlist = df.select('words').rdd.map(lambda line: ' '.join(line[0])).flatMap(lambda x: [x]).collect()\n\nfullidstringlist = df.select('id').rdd.flatMap(lambda x: [x]).collect()\n\nfullidstringlist = [x.id for x in fullidstringlist]\nprint(fulltextstringlist[0:10])\nprint(fullidstringlist[0:10])\n\n\n#allsents = fulltextstring.split('.')\n\n#allsentstokenized = [nltk.word_tokenize(sent) for sent in allsents]","user":"anonymous","dateUpdated":"2018-11-15T01:02:36+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=2","http://172.17.0.2:4040/jobs/job?id=3","http://172.17.0.2:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1541697994719_-145397751","id":"20181104-200239_1783795969","dateCreated":"2018-11-08T17:26:34+0000","dateStarted":"2018-11-13T17:48:13+0000","dateFinished":"2018-11-13T17:48:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4765"},{"text":"%pyspark\nnltk.download('wordnet')\nfrom nltk.stem import WordNetLemmatizer\nimport re\nfrom nltk.corpus import stopwords\nnltk.download('stopwords')\nstop_words = stopwords.words('english')\n\n\nfiltered_text_list = []\nfiltered_id_list = []\n\nfor i in range(0,len(fulltextstringlist)):\n    if len(fulltextstringlist[i])>0:\n        filtered_text_list.append(fulltextstringlist[i])\n        filtered_id_list.append(fullidstringlist[i])\n\nclean_text_list = []        \nfor i in range(0,len(filtered_text_list)):\n    clean_text_list.append([WordNetLemmatizer().lemmatize(w.lower()) for w in nltk.word_tokenize(filtered_text_list[i]) if w.lower().isalpha() and w.lower() not in stop_words and len(w.lower())>2 and len(w.lower())<17])\n\nprint(clean_text_list[0:10])        \n\n#data_remove_null.map(lambda line: re.split(' ', line[0])).map(lambda txt: [w.lower() for w in txt if w.lower().isalpha()]).map(lambda txt: [w for w in txt if w not in stop_words]).map(lambda txt: [w for w in txt if len(w) > 2 and len(w) < 17]).map(lambda txt: [WordNetLemmatizer().lemmatize(w) for w in txt])","user":"anonymous","dateUpdated":"2018-11-13T17:48:20+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541697994720_-389895857","id":"20181104-200621_236087335","dateCreated":"2018-11-08T17:26:34+0000","dateStarted":"2018-11-13T17:48:20+0000","dateFinished":"2018-11-13T17:48:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4766"},{"text":"%python.conda \ninstall gensim","user":"anonymous","dateUpdated":"2018-11-13T17:45:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541700320144_-502816502","id":"20181108-180520_2065621394","dateCreated":"2018-11-08T18:05:20+0000","dateStarted":"2018-11-13T17:45:59+0000","dateFinished":"2018-11-13T17:46:12+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4767"},{"text":"%pyspark\n#import pandas\nimport gensim\nimport gensim.corpora as corpora\nfrom gensim.utils import simple_preprocess\nfrom gensim.models import CoherenceModel\nfrom gensim.corpora import Dictionary","user":"anonymous","dateUpdated":"2018-11-13T17:48:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541699800834_-1387010736","id":"20181108-175640_1404010564","dateCreated":"2018-11-08T17:56:40+0000","dateStarted":"2018-11-13T17:48:33+0000","dateFinished":"2018-11-13T17:48:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4768"},{"text":"%pyspark\nfrom gensim.corpora import Dictionary\n\nid2word = corpora.Dictionary(clean_text_list)\nprint(id2word)\ntexts = clean_text_list\ncorpus = [id2word.doc2bow(text) for text in texts]\nprint(corpus[0:10])","user":"anonymous","dateUpdated":"2018-11-13T17:49:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541700309250_-446510902","id":"20181108-180509_450778277","dateCreated":"2018-11-08T18:05:09+0000","dateStarted":"2018-11-13T17:49:43+0000","dateFinished":"2018-11-13T17:49:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4769"},{"text":"%pyspark\nlda_model = gensim.models.ldamodel.LdaModel(corpus=corpus,\n                                           id2word=id2word,\n                                           num_topics=2, \n                                           random_state=100,\n                                           update_every=1,\n                                           chunksize=100,\n                                           passes=20,\n                                           alpha='auto',\n                                           per_word_topics=True)","user":"anonymous","dateUpdated":"2018-11-10T22:36:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541884891946_-2014249303","id":"20181110-212131_1618992720","dateCreated":"2018-11-10T21:21:31+0000","dateStarted":"2018-11-10T22:36:50+0000","dateFinished":"2018-11-10T22:36:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4770"},{"text":"%pyspark\nfrom pprint import pprint\npprint(lda_model.print_topics())\n","user":"anonymous","dateUpdated":"2018-11-10T21:23:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541884969715_457631118","id":"20181110-212249_1603811198","dateCreated":"2018-11-10T21:22:49+0000","dateStarted":"2018-11-10T21:23:51+0000","dateFinished":"2018-11-10T21:23:51+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4771"},{"text":"%pyspark\ncoherence_model_lda = CoherenceModel(model = lda_model, texts = texts, dictionary = id2word, coherence = 'c_v')\ncoherence_lda = coherence_model_lda.get_coherence()\nprint('Conherence score: ', coherence_lda)","user":"anonymous","dateUpdated":"2018-11-10T21:24:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541885031250_240966606","id":"20181110-212351_802355370","dateCreated":"2018-11-10T21:23:51+0000","dateStarted":"2018-11-10T21:24:41+0000","dateFinished":"2018-11-10T21:24:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4772"},{"text":"%pyspark\nfor i in range(3,50):\n    lda_model_loop = gensim.models.ldamodel.LdaModel(corpus=corpus,\n                                           id2word=id2word,\n                                           num_topics=i, \n                                           random_state=100,\n                                           update_every=1,\n                                           chunksize=100,\n                                           passes=20,\n                                           alpha='auto',\n                                           per_word_topics=True)\n    coherence_model_lda = CoherenceModel(model = lda_model_loop, texts = texts, dictionary = id2word, coherence = 'c_v')\n    coherence_lda = coherence_model_lda.get_coherence()\n    print('Topics:',i)\n    print('Conherence score: ', coherence_lda)","user":"anonymous","dateUpdated":"2018-11-10T22:37:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541885081287_-481874631","id":"20181110-212441_1532215101","dateCreated":"2018-11-10T21:24:41+0000","dateStarted":"2018-11-10T22:37:39+0000","dateFinished":"2018-11-10T22:45:46+0000","status":"ABORT","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4773"},{"text":"%pyspark\nlda_model_14 = gensim.models.ldamodel.LdaModel(corpus=corpus,\n                                           id2word=id2word,\n                                           num_topics=14, \n                                           random_state=100,\n                                           update_every=1,\n                                           chunksize=100,\n                                           passes=20,\n                                           alpha='auto',\n                                           per_word_topics=True)\ncoherence_model_lda = CoherenceModel(model = lda_model_14, texts = texts, dictionary = id2word, coherence = 'c_v')\ncoherence_lda = coherence_model_lda.get_coherence()\nprint('Conherence score: ', coherence_lda)","user":"anonymous","dateUpdated":"2018-11-13T18:04:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541885221350_1769906099","id":"20181110-212701_419429689","dateCreated":"2018-11-10T21:27:01+0000","dateStarted":"2018-11-13T18:04:58+0000","dateFinished":"2018-11-13T18:05:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4774"},{"text":"%pyspark\nfrom pprint import pprint\npprint(lda_model_14.print_topics())\n","user":"anonymous","dateUpdated":"2018-11-13T18:06:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541885712393_1594649203","id":"20181110-213512_2130584406","dateCreated":"2018-11-10T21:35:12+0000","dateStarted":"2018-11-13T18:06:15+0000","dateFinished":"2018-11-13T18:06:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4775"},{"text":"%pyspark\nstrong_matthew_ids = []\nfor i in range(0 , len(corpus)):\n    for (topic, strength) in lda_model_14[corpus[i]][0]:\n        if (topic == 4 or topic == 5 or topic == 12) and strength > 0.9:\n            strong_matthew_ids.append(i)\nprint(strong_matthew_ids)\nprint(len(strong_matthew_ids))","user":"anonymous","dateUpdated":"2018-11-13T18:08:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541885737506_-1840959242","id":"20181110-213537_1290650887","dateCreated":"2018-11-10T21:35:37+0000","dateStarted":"2018-11-13T18:08:31+0000","dateFinished":"2018-11-13T18:08:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4776"},{"text":"%pyspark\nprint(filtered_text_list[180])","user":"anonymous","dateUpdated":"2018-11-10T21:47:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541886280444_-1051885276","id":"20181110-214440_2047414700","dateCreated":"2018-11-10T21:44:40+0000","dateStarted":"2018-11-10T21:47:53+0000","dateFinished":"2018-11-10T21:47:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4777"},{"text":"%pyspark\nf = open(\"/share_dir/lda_filtered_docs_small.json\",\"w\")","user":"anonymous","dateUpdated":"2018-11-13T18:15:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541888178873_2112596372","id":"20181110-221618_699422097","dateCreated":"2018-11-10T22:16:18+0000","dateStarted":"2018-11-13T18:15:54+0000","dateFinished":"2018-11-13T18:15:54+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4779"},{"text":"%pyspark\nfor index in strong_matthew_ids:\n    f.write(\"{\\\"URL\\\":\\\"\"+ filtered_id_list[index] + \"\\\",\\\"Timestamp\\\":\\\"000000000000\\\",\\\"Sentences\\\":\\\"\" + filtered_text_list[index] + \"\\\"}\\n\")","user":"anonymous","dateUpdated":"2018-11-13T18:15:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542132646959_899126183","id":"20181113-181046_1500657146","dateCreated":"2018-11-13T18:10:46+0000","dateStarted":"2018-11-13T18:15:57+0000","dateFinished":"2018-11-13T18:15:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4780"},{"text":"%pyspark\nfiltered_sentence_list = [nltk.sent_tokenize(text) for text in filtered_text_list]","user":"anonymous","dateUpdated":"2018-11-15T00:53:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541886365324_-863882878","id":"20181110-214605_1737567103","dateCreated":"2018-11-10T21:46:05+0000","dateStarted":"2018-11-15T00:53:08+0000","dateFinished":"2018-11-15T00:53:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4778","focus":true},{"text":"%pyspark\nfiltered_sentence_list[0:5]","user":"anonymous","dateUpdated":"2018-11-15T00:53:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542132895739_815440685","id":"20181113-181455_774326134","dateCreated":"2018-11-13T18:14:55+0000","dateStarted":"2018-11-15T00:53:27+0000","dateFinished":"2018-11-15T00:53:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4781"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-11-15T00:53:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542243207669_-1282742497","id":"20181115-005327_222442124","dateCreated":"2018-11-15T00:53:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4782"}],"name":"LDA filtering","id":"2DVEHAGP1","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}