{
  "paragraphs": [
    {
      "text": "%md\nLDA Topic Model",
      "user": "anonymous",
      "dateUpdated": "2018-10-24 21:00:59.515",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eLDA Topic Model\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1540414847206_1525190744",
      "id": "20181024-210047_134098203",
      "dateCreated": "2018-10-24 21:00:47.206",
      "dateStarted": "2018-10-24 21:00:59.540",
      "dateFinished": "2018-10-24 21:01:02.930",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nTopic Modeling using: https://www.machinelearningplus.com/nlp/topic-modeling-gensim-python/",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 16:25:00.948",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539312740426_-737601130",
      "id": "20181012-025220_1438348555",
      "dateCreated": "2018-10-12 02:52:20.426",
      "dateStarted": "2018-10-20 16:25:00.979",
      "dateFinished": "2018-10-20 16:25:04.283",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "\n%python.conda install gensim",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:17:58.460",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539976364316_-1469056205",
      "id": "20181019-191244_1033328016",
      "dateCreated": "2018-10-19 19:12:44.316",
      "dateStarted": "2018-10-20 02:17:58.560",
      "dateFinished": "2018-10-20 02:22:02.165",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%python.conda\ninstall -c conda-forge pyldavis",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:23:31.600",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539312777294_1989540524",
      "id": "20181012-025257_1624869726",
      "dateCreated": "2018-10-12 02:52:57.294",
      "dateStarted": "2018-10-20 02:23:31.723",
      "dateFinished": "2018-10-20 02:24:59.503",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nimport pandas",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:27:49.685",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539625845995_-1727734235",
      "id": "20181015-175045_529401850",
      "dateCreated": "2018-10-15 17:50:45.995",
      "dateStarted": "2018-10-20 02:27:49.805",
      "dateFinished": "2018-10-20 02:28:06.327",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n#import pandas\nimport gensim\nimport gensim.corpora as corpora\nfrom gensim.utils import simple_preprocess\nfrom gensim.models import CoherenceModel",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:28:15.821",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539312874729_-200923000",
      "id": "20181012-025434_1750277013",
      "dateCreated": "2018-10-12 02:54:34.729",
      "dateStarted": "2018-10-20 02:28:15.915",
      "dateFinished": "2018-10-20 02:28:16.548",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nimport pyLDAvis\nimport pyLDAvis.gensim",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:28:22.996",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539312962641_-1569494711",
      "id": "20181012-025602_208166429",
      "dateCreated": "2018-10-12 02:56:02.641",
      "dateStarted": "2018-10-20 02:28:23.083",
      "dateFinished": "2018-10-20 02:28:23.228",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n#import spacy\nimport nltk\nimport re\nfrom nltk.corpus import stopwords\nnltk.download(\u0027stopwords\u0027)\nstop_words \u003d stopwords.words(\u0027english\u0027)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:28:26.964",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539312989665_-1595008913",
      "id": "20181012-025629_758005730",
      "dateCreated": "2018-10-12 02:56:29.665",
      "dateStarted": "2018-10-20 02:28:27.085",
      "dateFinished": "2018-10-20 02:28:28.010",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n#import numpy as np\n#import gensim\nfrom pprint import pprint",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:28:31.429",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539313060690_1701622914",
      "id": "20181012-025740_1484867698",
      "dateCreated": "2018-10-12 02:57:40.690",
      "dateStarted": "2018-10-20 02:28:31.546",
      "dateFinished": "2018-10-20 02:28:31.557",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\npath \u003d \"/share_dir/sample_output_clean/*.json\"\nhtmlDF \u003d spark.read.json(path)\nhtmlDF.show()",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:28:35.589",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539313023558_-1483755365",
      "id": "20181012-025703_145097964",
      "dateCreated": "2018-10-12 02:57:03.558",
      "dateStarted": "2018-10-20 02:28:35.693",
      "dateFinished": "2018-10-20 02:28:41.133",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndoc \u003d htmlDF.select(\u0027URL\u0027, \u0027Sentences\u0027)\ndoc.show()",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:28:44.423",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539313038126_-1975659048",
      "id": "20181012-025718_1265062336",
      "dateCreated": "2018-10-12 02:57:18.126",
      "dateStarted": "2018-10-20 02:28:44.530",
      "dateFinished": "2018-10-20 02:28:44.934",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# remove null element from data (MapPartitionsRDD)\nnltk.download(\u0027wordnet\u0027)\nfrom nltk.stem import WordNetLemmatizer\n\ndata \u003d htmlDF.select(\u0027Sentences\u0027).rdd\ndata_remove_null \u003d data.filter(lambda e: len(e) \u003e 0)\n\n#tokenize words and filter out stop_words and not alpha and length is between 3 and 16\nword_filter \u003d data_remove_null.map(lambda line: re.split(\u0027 \u0027, line[0])).map(lambda txt: [w.lower() for w in txt if w.lower().isalpha()]).map(lambda txt: [w for w in txt if w not in stop_words]).map(lambda txt: [w for w in txt if len(w) \u003e 2 and len(w) \u003c 17]).map(lambda txt: [WordNetLemmatizer().lemmatize(w) for w in txt])\n#sc.parallelize(data_remove_null).map(lambda line: re.split(\u0027 \u0027, line[0]))\n#.filter(lambda word: word.lower().isalpha())\n#.filter(lambda word: word.lower() not in stop_words).filter(lambda word: len(word) \u003e 2).filter(lambda word: len(word) \u003c 17)\nword_filter.take(3)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:28:49.929",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539447502367_1600388528",
      "id": "20181013-161822_723250142",
      "dateCreated": "2018-10-13 16:18:22.368",
      "dateStarted": "2018-10-20 02:28:50.030",
      "dateFinished": "2018-10-20 02:28:56.281",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndf \u003d (doc.rdd.map(lambda x : (x.URL, x.Sentences.split(\" \"))).toDF()).withColumnRenamed(\"_1\", \"id\").withColumnRenamed(\"_2\", \"words\")\ndf.show()",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:28:59.330",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539313087061_107820439",
      "id": "20181012-025807_228404363",
      "dateCreated": "2018-10-12 02:58:07.061",
      "dateStarted": "2018-10-20 02:28:59.431",
      "dateFinished": "2018-10-20 02:29:00.181",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nnltk.download(\u0027wordnet\u0027)\nfrom nltk.stem import WordNetLemmatizer\n\ndf_filter \u003d (df.rdd.map(lambda r : (r.id, [WordNetLemmatizer().lemmatize(w) for w in r.words if w.lower().isalpha() and w.lower() not in stop_words and len(w) \u003e 2]))).toDF().withColumnRenamed(\"_1\", \"doc_id\").withColumnRenamed(\"_2\", \"words\")\ndf_filter.show()",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:29:04.852",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539314660201_1630287891",
      "id": "20181012-032420_906115784",
      "dateCreated": "2018-10-12 03:24:20.202",
      "dateStarted": "2018-10-20 02:29:04.957",
      "dateFinished": "2018-10-20 02:29:10.799",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndf_filter.show()",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:29:14.425",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539451370390_1593735499",
      "id": "20181013-172250_222822451",
      "dateCreated": "2018-10-13 17:22:50.390",
      "dateStarted": "2018-10-20 02:29:14.545",
      "dateFinished": "2018-10-20 02:29:17.381",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nCreate a Bag of Words and Build LDA model with a bag of words",
      "user": "anonymous",
      "dateUpdated": "2018-10-13 15:15:50.073",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539442814848_1686258977",
      "id": "20181013-150014_1999102886",
      "dateCreated": "2018-10-13 15:00:14.848",
      "dateStarted": "2018-10-13 15:15:50.073",
      "dateFinished": "2018-10-13 15:15:50.098",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndata \u003d df_filter.select(\u0027words\u0027).collect()\nd2 \u003d data[1:3]",
      "user": "anonymous",
      "dateUpdated": "2018-10-15 17:00:09.913",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539442839340_1058025776",
      "id": "20181013-150039_682419232",
      "dateCreated": "2018-10-13 15:00:39.340",
      "dateStarted": "2018-10-15 17:00:10.038",
      "dateFinished": "2018-10-15 17:00:14.963",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n#Get word filter from clean data\n#Prepare data for running LDA model\ndata \u003d word_filter.collect()\nd2 \u003d data[1: 442]",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:29:57.199",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539444876572_1888422090",
      "id": "20181013-153436_1979896428",
      "dateCreated": "2018-10-13 15:34:36.573",
      "dateStarted": "2018-10-20 02:29:57.286",
      "dateFinished": "2018-10-20 02:29:58.962",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nd2[26]",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:30:01.924",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539459561643_1634440000",
      "id": "20181013-193921_1706417030",
      "dateCreated": "2018-10-13 19:39:21.648",
      "dateStarted": "2018-10-20 02:30:02.017",
      "dateFinished": "2018-10-20 02:30:02.039",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nlen(d2)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:30:05.440",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539451751628_1220293634",
      "id": "20181013-172911_93609879",
      "dateCreated": "2018-10-13 17:29:11.628",
      "dateStarted": "2018-10-20 02:30:05.514",
      "dateFinished": "2018-10-20 02:30:05.527",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom gensim.corpora import Dictionary\n\nid2word \u003d corpora.Dictionary(d2)\nprint(id2word)\ntexts \u003d d2\ntexts\ncorpus \u003d [id2word.doc2bow(text) for text in texts]\ncorpus",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:30:08.030",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539443259016_-45127863",
      "id": "20181013-150739_1371641642",
      "dateCreated": "2018-10-13 15:07:39.016",
      "dateStarted": "2018-10-20 02:30:08.123",
      "dateFinished": "2018-10-20 02:30:08.645",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n#Build LDA model\nlda_model \u003d gensim.models.ldamodel.LdaModel(corpus\u003dcorpus,\n                                           id2word\u003did2word,\n                                           num_topics\u003d2, \n                                           random_state\u003d100,\n                                           update_every\u003d1,\n                                           chunksize\u003d100,\n                                           passes\u003d20,\n                                           alpha\u003d\u0027auto\u0027,\n                                           per_word_topics\u003dTrue)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:32:33.280",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539443730266_-2015377196",
      "id": "20181013-151530_1014843365",
      "dateCreated": "2018-10-13 15:15:30.266",
      "dateStarted": "2018-10-20 02:32:33.377",
      "dateFinished": "2018-10-20 02:32:39.531",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndoc_lda \u003d lda_model[corpus]\npprint(lda_model.print_topics())",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:32:36.943",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539443794828_928983042",
      "id": "20181013-151634_1318793199",
      "dateCreated": "2018-10-13 15:16:34.828",
      "dateStarted": "2018-10-20 02:32:37.080",
      "dateFinished": "2018-10-20 02:32:39.561",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Computer Coherence Score\ncoherence_model_lda \u003d CoherenceModel(model \u003d lda_model, texts \u003d d2, dictionary \u003d id2word, coherence \u003d \u0027c_v\u0027)\ncoherence_lda \u003d coherence_model_lda.get_coherence()\nprint(\u0027Conherence score: \u0027, coherence_lda)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:32:51.343",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539622221441_-1726979576",
      "id": "20181015-165021_520368726",
      "dateCreated": "2018-10-15 16:50:21.441",
      "dateStarted": "2018-10-20 02:32:51.439",
      "dateFinished": "2018-10-20 02:32:54.799",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nvis \u003d pyLDAvis.gensim.prepare(lda_model, corpus, id2word)\nvis",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:33:00.372",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539443961729_-391389669",
      "id": "20181013-151921_1046233805",
      "dateCreated": "2018-10-13 15:19:21.729",
      "dateStarted": "2018-10-20 02:33:00.451",
      "dateFinished": "2018-10-20 02:33:03.109",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%python.ipython\n\n#Visualize the topics\n#pyLDAvis.enable_notebook()\nvis \u003d pyLDAvis.gensim.prepare(lda_model, corpus, id2word)\npyLDAvis.display(vis)\nvis",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:33:32.092",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539459695709_1933428435",
      "id": "20181013-194135_1068000464",
      "dateCreated": "2018-10-13 19:41:35.710",
      "dateStarted": "2018-10-20 02:33:32.210",
      "dateFinished": "2018-10-20 02:33:32.917",
      "status": "ERROR",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nmallet_path \u003d \u0027/share_dir/ex_files/mallet-2.0.8/bin/mallet\u0027 # update this path\nldamallet \u003d gensim.models.wrappers.LdaMallet(mallet_path, corpus\u003dcorpus, num_topics\u003d2, id2word\u003did2word)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:33:51.699",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539444111636_-280863433",
      "id": "20181013-152151_1347689965",
      "dateCreated": "2018-10-13 15:21:51.636",
      "dateStarted": "2018-10-20 02:33:51.774",
      "dateFinished": "2018-10-20 02:34:28.173",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Show Topics\npprint(ldamallet.show_topics(formatted\u003dFalse))\n\n# Compute Coherence Score\ncoherence_model_ldamallet \u003d CoherenceModel(model\u003dldamallet, texts\u003dd2, dictionary\u003did2word, coherence\u003d\u0027c_v\u0027)\ncoherence_ldamallet \u003d coherence_model_ldamallet.get_coherence()\nprint(\u0027\\nCoherence Score: \u0027, coherence_ldamallet)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:34:43.786",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539444175873_-1038913652",
      "id": "20181013-152255_1278925240",
      "dateCreated": "2018-10-13 15:22:55.873",
      "dateStarted": "2018-10-20 02:34:43.862",
      "dateFinished": "2018-10-20 02:34:47.299",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Define a function to run LDA model with different number of topic and then find the optimal number of topic\ndef compute_coherence_values(dictionary, corpus, texts, limit, start\u003d2, step\u003d3):\n    coherence_values \u003d []\n    model_list \u003d []\n    for num_topics in range(start, limit, step):\n        model \u003d gensim.models.wrappers.LdaMallet(mallet_path, corpus\u003dcorpus, num_topics\u003dnum_topics, id2word\u003did2word)\n        model_list.append(model)\n        coherencemodel \u003d CoherenceModel(model\u003dmodel, texts\u003dtexts, dictionary\u003ddictionary, coherence\u003d\u0027c_v\u0027)\n        coherence_values.append(coherencemodel.get_coherence())\n\n    return model_list, coherence_values",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:35:26.196",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539448271018_714898041",
      "id": "20181013-163111_1644972197",
      "dateCreated": "2018-10-13 16:31:11.018",
      "dateStarted": "2018-10-20 02:35:26.269",
      "dateFinished": "2018-10-20 02:35:26.280",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nmodel_list, coherence_values \u003d compute_coherence_values(dictionary\u003did2word, corpus\u003dcorpus, texts\u003dd2, start\u003d2, limit\u003d50, step\u003d5)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:35:28.630",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539625040389_-1269849749",
      "id": "20181015-173720_704701656",
      "dateCreated": "2018-10-15 17:37:20.389",
      "dateStarted": "2018-10-20 02:35:28.691",
      "dateFinished": "2018-10-20 02:44:55.285",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Print the coherence scores\nimport matplotlib.pyplot as plt\nlimit\u003d50; start\u003d2; step\u003d5;\nx \u003d range(start, limit, step)\nplt.plot(x, coherence_values)\nplt.xlabel(\"Num Topics\")\nplt.ylabel(\"Coherence score\")\nplt.legend((\"coherence_values\"), loc\u003d\u0027best\u0027)\nplt.show()",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:50:46.708",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539625102783_453793877",
      "id": "20181015-173822_1952832136",
      "dateCreated": "2018-10-15 17:38:22.783",
      "dateStarted": "2018-10-20 02:50:46.802",
      "dateFinished": "2018-10-20 02:50:47.425",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfor m, cv in zip(x, coherence_values):\n    print(\"Num Topics \u003d\", m, \" has Coherence Value of\", round(cv, 4))",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 02:52:30.977",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539625493249_-19578620",
      "id": "20181015-174453_317085693",
      "dateCreated": "2018-10-15 17:44:53.249",
      "dateStarted": "2018-10-20 02:52:31.066",
      "dateFinished": "2018-10-20 02:52:31.086",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Select the model with the highest coherence value and print the topics\noptimal_model \u003d model_list[5]\nmodel_topics \u003d optimal_model.show_topics(formatted\u003dFalse)\npprint(optimal_model.print_topics(num_words\u003d10))",
      "user": "anonymous",
      "dateUpdated": "2018-10-23 15:45:49.634",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539625549667_-2012428667",
      "id": "20181015-174549_1905946535",
      "dateCreated": "2018-10-15 17:45:49.668",
      "dateStarted": "2018-10-20 02:53:00.290",
      "dateFinished": "2018-10-20 02:53:00.329",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndef format_topics_sentences(ldamodel\u003dlda_model, corpus\u003dcorpus, texts\u003ddata):\n    # Init output\n    sent_topics_df \u003d pandas.DataFrame()\n\n    # Get main topic in each document\n    for i, row in enumerate(ldamodel[corpus]):\n        row \u003d sorted(row, key\u003dlambda x: (x[1]), reverse\u003dTrue)\n        # Get the Dominant topic, Perc Contribution and Keywords for each document\n        for j, (topic_num, prop_topic) in enumerate(row):\n            if j \u003d\u003d 0:  # \u003d\u003e dominant topic\n                wp \u003d ldamodel.show_topic(topic_num)\n                topic_keywords \u003d \", \".join([word for word, prop in wp])\n                sent_topics_df \u003d sent_topics_df.append(pandas.Series([int(topic_num), round(prop_topic,4), topic_keywords]), ignore_index\u003dTrue)\n            else:\n                break\n    sent_topics_df.columns \u003d [\u0027Dominant_Topic\u0027, \u0027Perc_Contribution\u0027, \u0027Topic_Keywords\u0027]\n\n    # Add original text to the end of the output\n    contents \u003d pandas.Series(texts)\n    sent_topics_df \u003d pandas.concat([sent_topics_df, contents], axis\u003d1)\n    return(sent_topics_df)\n\n\ndf_topic_sents_keywords \u003d format_topics_sentences(ldamodel\u003doptimal_model, corpus\u003dcorpus, texts\u003dd2)\n\n# Format\ndf_dominant_topic \u003d df_topic_sents_keywords.reset_index()\ndf_dominant_topic.columns \u003d [\u0027Document_No\u0027, \u0027Dominant_Topic\u0027, \u0027Topic_Perc_Contrib\u0027, \u0027Keywords\u0027, \u0027Text\u0027]\n\n# Show\ndf_dominant_topic.head(10)",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 03:06:33.289",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {}
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1539635594497_1575869326",
      "id": "20181015-203314_2113794009",
      "dateCreated": "2018-10-15 20:33:14.497",
      "dateStarted": "2018-10-20 03:06:33.361",
      "dateFinished": "2018-10-20 03:06:37.251",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Group top 5 sentences under each topic\nsent_topics_sorteddf_mallet \u003d pandas.DataFrame()\n\nsent_topics_outdf_grpd \u003d df_topic_sents_keywords.groupby(\u0027Dominant_Topic\u0027)\n\nfor i, grp in sent_topics_outdf_grpd:\n    sent_topics_sorteddf_mallet \u003d pandas.concat([sent_topics_sorteddf_mallet, \n                                             grp.sort_values([\u0027Perc_Contribution\u0027], ascending\u003d[0]).head(1)], \n                                            axis\u003d0)\n\n# Reset Index    \nsent_topics_sorteddf_mallet.reset_index(drop\u003dTrue, inplace\u003dTrue)\n\n# Format\nsent_topics_sorteddf_mallet.columns \u003d [\u0027Topic_Num\u0027, \"Topic_Perc_Contrib\", \"Keywords\", \"Text\"]\n\n# Show\nsent_topics_sorteddf_mallet.head()",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 03:07:31.487",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1540004727459_-333324689",
      "id": "20181020-030527_1260000165",
      "dateCreated": "2018-10-20 03:05:27.459",
      "dateStarted": "2018-10-20 03:07:31.613",
      "dateFinished": "2018-10-20 03:07:31.690",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Number of Documents for Each Topic\ntopic_counts \u003d df_topic_sents_keywords[\u0027Dominant_Topic\u0027].value_counts()\n\n# Percentage of Documents for Each Topic\n#topic_contribution \u003d round(topic_counts/topic_counts.sum(), 4)\ntopic_contribution \u003d topic_counts/topic_counts.sum()\n\n# Topic Number and Keywords\ntopic_num_keywords \u003d df_topic_sents_keywords[[\u0027Dominant_Topic\u0027, \u0027Topic_Keywords\u0027]]\n\n# Concatenate Column wise\ndf_dominant_topics \u003d pandas.concat([topic_num_keywords, topic_counts, topic_contribution], axis\u003d1)\n\n# Change Column names\ndf_dominant_topics.columns \u003d [\u0027Dominant_Topic\u0027, \u0027Topic_Keywords\u0027, \u0027Num_Documents\u0027, \u0027Perc_Documents\u0027]\n\n# Show\ndf_dominant_topics",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 03:12:04.118",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1540004840685_-613983748",
      "id": "20181020-030720_327294531",
      "dateCreated": "2018-10-20 03:07:20.685",
      "dateStarted": "2018-10-20 03:11:39.795",
      "dateFinished": "2018-10-20 03:11:39.829",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndf_dominant_topics[\u0027Topic_Keywords\u0027]",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 03:17:31.570",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1540004889146_-272559056",
      "id": "20181020-030809_774759517",
      "dateCreated": "2018-10-20 03:08:09.147",
      "dateStarted": "2018-10-20 03:17:31.651",
      "dateFinished": "2018-10-20 03:17:31.664",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2018-10-20 03:13:56.505",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1540005236504_691067977",
      "id": "20181020-031356_1769323845",
      "dateCreated": "2018-10-20 03:13:56.504",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Topic 6 - LDA Topic Modeling",
  "id": "2DT1JB2Y6",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "python:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}